# Module 1 Lesson 8: AI Sidebar Agent：上下文机制与执行授权管理

> **课程体系：Learn Python with AI IDE**
> **当前模块**：Module 1 - The AI Ready Engineer
> **本课目标**：掌握 AI IDE 侧边栏助手（Agent）的核心交互逻辑。理解其如何通过原生接口（API）与终端指令协同工作，并学会管理复杂的执行授权。

### 🔙 前修回顾
在之前的课程中，我们完成了终端环境、Conda 配置及标准化工作台的搭建。这些基础是你能够安全、可控地驱策 AI 的前提。只有当你理解了文件路径和环境逻辑，AI 的动作才不会成为“黑箱”。

### 📅 今日预告
今天我们正式引入 **AI Sidebar Agent（侧边栏助手）**。它是你深度协作的窗口。你会发现，它不仅会聊天，还拥有一套超越人类敲击键盘效率的“开发者工具箱”。

---

### 协作的配置：让 AI 听你的
在开始实战之前，我们需要先调整好我们的“协作底座”。请点击 IDE 底部状态栏右下角的 **Antigravity Settings** 按钮，完成如下配置：

*   **Model**: 选择 `Gemini 3 Flash`（最新高性能轻量模型）。
*   **Conversation mode**: 设置为 `Fast`（快速响应）。
*   **Auto execution**: 设置为 `Always Proceed`（始终进行）。
    *   **设置入口**：在 IDE 底部状态栏右下角的 **Antigravity Settings** 面板中即可找到。这是允许 AI 自动执行指令（如创建文件、运行命令）的“自动驾驶”开关。
    *   *注：本课的目标是体验“全速协作”。至于面板中的其他配置项，我们会在后续课程中逐一揭秘，现在你也可以凭直觉大胆探索。*

---

### 上下文层级：AI 是如何“感知”你的？
传统的 Web AI（如 ChatGPT）与你的代码库是隔裂的。而 **AI IDE 的侧边栏** 真正实现了 **上下文感知 (Context Awareness)**。它能通过后台的“感知工具”（如 `list_dir` 目录探测）来看清你的项目全景。

目前主流 AI IDE 的上下文选取逻辑遵循以下层级：
1.  **静默优先**：你当前正在关注的文件。
2.  **显式指定**：使用 `@` 符号手动引用的文件。这是多文件协作时的精确控制工具。
3.  **对话历史**：当前对话框中已有的聊天记录。
4.  **环境探测**：AI 可能会静悄悄地扫描你的目录结构，以便在回答时照顾到全局。

---

### 原生接口 vs. 终端指令：AI 的工具箱
你可能会好奇：为什么 AI 有时能瞬间创建文件，却没看到它在终端敲代码？

这是因为 Agent 拥有两套武器：
-   **Native API (原生接口)**：AI 直接调用 `write_to_file` 等底层指令。它不需要模拟键盘，效率极高且不易出错。
-   **Terminal Shell (终端指令)**：当需要运行代码（`python`）、安装包（`pip`）或进行复杂搜索（`grep`）时，AI 会切换到终端模式。

你可以把它理解为一个**深度集成的智能插件**。虽然它有时“静悄悄”地干活，但每一项动作都受到你设置的 `Auto execution` 权限管控。

---

### 任务一：辅助阅读 —— 上下文联动练习
我们要练习 AI 的“辅助阅读”能力，并实测刚才提到的**上下文层级**。

1.  **准备**：在编辑器中打开你之前写的 `hello.py`。
2.  **验证“静默优先”**：直接在侧边栏问：“解释一下当前文件的功能。”你会发现 AI 自动锁定了 `hello.py`，这就是层级 1 的威力。
3.  **练习“显式指定”**：在输入框输入 `@`，然后在列表中手动选择 `hello.py`（即便它已经打开了）。
    *   *联动：当你需要对比 A 文件改写 B 文件时，通过 `@` 显式指定（层级 2）是确保 AI 不跑偏的关键。*
4.  **发起对话**：输入“请说明这段代码的运行原理。”

---

### 任务二：辅助写作 —— 原生接口的“静默”威力
接下来，我们要体验 AI 如何通过原生接口（层级 4 的探测 + API 写入）高效工作。

1.  **重置**：点击侧边栏顶部的 **New Chat**，清理上下文。
2.  **下令**：在输入框输入：
    > “请帮我在当前目录下创建一个 README.md 文件。内容要包含你对我目前目录结构的观察。”
3.  **观察执行过程**：
    *   **感知**：你会发现 AI 先静悄悄地执行了探测指令（联动层级 4）。
    *   **执行**：由于开启了 `Always Proceed`，AI 会直接调用 `write_to_file` 接口。你不会看到终端跳动，文件瞬间就会生成。
4.  **验证结果**：
    查看左侧 **文件管理器 (Explorer)**。`README.md` 应该已经躺在那里了！点击打开它，确认 AI 是否准确识别了你的文件夹（如 `scripts` 等）。

---

### 任务三：掌控力 —— 通过终端运行代码
AI 不仅能写，还能“代打”终端。我们将实测 AI 同时处理多个任务的控制力。

1.  **下令**：在对话框输入：“请帮我运行 scripts 文件夹下所有的 Python 文件。”
2.  **观察 AI 的思考与调度**：
    *   **思考过程**：你会看到界面上出现 `Thought for ...` 的跳动，这是 AI 在进行逻辑拆解（Analyzed scripts）。
    *   **多任务并发**：在侧边栏底部，你会看到 AI 瞬间创建了多个并行的终端任务。观察每一个任务条：
        *   你会看到熟悉的 `python3 .../script_name.py` 指令。
        *   注意右下角的状态：`Exit code 0` 和 `Always Proceed`。
3.  **UI 交互：Go to Terminal vs. Relocate**：
    *   对于简单的脚本（如 `hello.py`），你会看到 **Go to Terminal**。
    *   特别留意 `path_check.py` 这个任务条，你会看到一个特殊的按钮：**Relocate（重定位）**。
4.  **Relocate：移动主权**：
    *   点击 `path_check.py` 任务条上的 **Relocate** 按钮。
    *   **见证**：你会发现这个原本“活”在侧边栏微型串口里的任务，瞬间跳转到了我们 L2 学过的**下方传统终端区**。
    *   此时，你可以清晰地观察到 `path_check.py` 输出的“路径仪表盘”（包含 CWD、相对路径和绝对路径）。
5.  **阅读最终总结**：
    *   当所有脚本运行完毕，AI 会给出一个工整的汇总报告。核对一下：`ide_demo.py`、`nothing.py` 等脚本的输出是否都如预想的一样？
    *   **主权复位**：你可以在下方终端区像操作普通终端一样继续输入指令。这再次证明了：AI 是终端的“代打”，而你永远是终端的“主人”。

---

### 💡 结语：从“工具”到“代理”的思维跃迁
今天你不仅学会了操作侧边栏，更重要的是，你拆解了 AI 工作的暗流：它是如何感知环境、如何选择 API、如何调度终端的。

当你学会使用 `@` 指路，并在 `Always Proceed` 的引擎声中熟练地重定位终端窗口时，你已经不再是一个被动接收答案的用户，而是一个正在指挥高度精密工场的**总调度师**。

这种“全速模式”的自动化是一把双刃剑。当 AI 开始静悄悄地探测并瞬发指令时，你该如何确保自己在享受效率的同时，不失去对代码灵魂的掌控？这就引出了我们下一课的核心：主权。

---

## 下节课程预览：如何检查 AI 的作业？验证、反馈与纠偏
在踏入真正的编码实战前，我们需要建立起最后一道防线。我们将探讨如何在极速协作中保持清醒，通过 **Human-AI Loop** 建立起真正的工程主权。
