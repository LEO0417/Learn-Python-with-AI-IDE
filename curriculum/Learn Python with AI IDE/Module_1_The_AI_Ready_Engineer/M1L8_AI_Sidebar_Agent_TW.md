# Module 1 Lesson 8: AI Sidebar Agent：上下文機制與執行授權管理

> **課程體系：Learn Python with AI IDE**
> **當前模組**：Module 1 - The AI Ready Engineer
> **本課目標**：掌握 AI IDE 側邊欄助手（Agent）的核心交互邏輯。理解其如何透過原生 API 與終端機指令協同工作，並學會管理複雜的執行授權。

### 🔙 前修回顧
在之前的課程中，我們完成了終端機環境、Conda 配置及標準化工作台的搭建。這些基礎是你能夠安全、可控地驅策 AI 的前提。只有當你理解了檔案路徑和環境邏輯，AI 的動作才不會成為「黑箱」。

### 📅 今日預告
今天我們正式引入 **AI Sidebar Agent（側邊欄助手）**。它是你深度協作的窗口。你會發現，它不僅會聊天，還擁有一套超越人類敲擊鍵盤效率的「開發者工具箱」。

---

### 協作的配置：讓 AI 聽你的
在開始實作之前，我們需要先調整好我們的「協作底座」。請點擊 IDE 底部狀態列右下角的 **Antigravity Settings** 按鈕，完成如下配置：

*   **Model**: 選擇 `Gemini 3 Flash`（最新高性能輕量模型）。
*   **Conversation mode**: 設置為 `Fast`（快速響應）。
*   **Auto execution**: 設置為 `Always Proceed`（始終進行）。
    *   **設置入口**：在 IDE 底部狀態列右下角的 **Antigravity Settings** 面板中即可找到。這是允許 AI 自動執行指令（如創建檔案、執行指令）的「自動駕駛」開關。
    *   *註：本課的目標是體驗「全速協作」。至於面板中的其他配置項，我們會在後續課程中逐一揭秘，現在你也可以憑直覺大膽探索。*

---

### 上下文層級：AI 是如何「感知」你的？
傳統的 Web AI（如 ChatGPT）與你的程式碼庫是割裂的。而 **AI IDE 的側邊欄** 真正實現了 **上下文感知 (Context Awareness)**。它能透過後台的「感知工具」（如 `list_dir` 目錄探測）來看清你的專案全景。

目前主流 AI IDE 的上下文選取邏輯遵循以下層級：
1.  **靜默優先**：你當前正在關注的檔案。
2.  **顯式指定**：使用 `@` 符號手動引用的檔案。這是多檔案協作時的精確控制工具。
3.  **對話歷史**：當前對話框中已有的聊天記錄。
4.  **環境探測**：AI 可能會靜悄悄地掃描你的目錄結構，以便在回答時照顧到全局。

---

### 原生 API vs. 終端機指令：AI 的工具箱
你可能會好奇：為什麼 AI 有時能瞬間創建檔案，卻沒看到他在終端機敲程式碼？

這是因為 Agent 擁有兩套武器：
-   **Native API (原生介面)**：AI 直接呼叫 `write_to_file` 等底層指令。它不需要模擬鍵盤，效率極高且不易出錯。
-   **Terminal Shell (終端機指令)**：當需要執行程式碼（`python`）、安裝包（`pip`）或進行複雜搜尋（`grep`）時，AI 會切換到終端機模式。

你可以把他理解為一個**深度整合的智慧外掛**。雖然它有時「靜悄悄」地幹活，但每一項動作都受到你設置的 `Auto execution` 權限管控。

---

### 任務一：輔助閱讀 —— 上下文聯動練習
我們要練習 AI 的「輔助閱讀」能力，並實測剛才提到的**上下文層級**。

1.  **準備**：在編輯器中打開你之前寫的 `hello.py`。
2.  **驗證「靜默優先」**：直接在側邊欄問：「解釋一下當前檔案的功能。」你會發現 AI 自動鎖定了 `hello.py`，這就是層級 1 的威力。
3.  **練習「顯式指定」**：在輸入框輸入 `@`，然後在列表中手動選擇 `hello.py`（即便它已經打開了）。
    *   *聯動：當你需要對比 A 檔案改寫 B 檔案時，透過 `@` 顯式指定（層級 2）是確保 AI 不跑偏的關鍵。*
4.  **發起對話**：輸入「請說明這段程式碼的運行原理。」

---

### 任務二：輔助寫作 —— 原生 API 的「靜默」威力
接下來，我們要體驗 AI 如何透過原生 API（層級 4 的探測 + API 寫入）高效工作。

1.  **重置**：點擊側邊欄頂部的 **New Chat**，清理上下文。
2.  **下令**：在輸入框輸入：
    > 「請幫我在當前目錄下創建一個 README.md 檔案。內容要包含你對我目前目錄結構的觀察。」
3.  **觀察執行過程**：
    *   **感知**：你會發現 AI 先靜悄悄地執行了探測指令（聯動層級 4）。
    *   **執行**：由於開啟了 `Always Proceed`，AI 會直接呼叫 `write_to_file` API。你不會看到終端機跳動，檔案瞬間就會生成。
4.  **驗證結果**：
    查看左侧 **檔案管理員 (Explorer)**。`README.md` 應該已經躺在那裡了！點擊打開它，確認 AI 是否準確識別了你的資料夾（如 `scripts` 等）。

---

### 任務三：掌控力 —— 透過終端機執行程式碼
AI 不僅能寫，還能「代打」終端機。我們將實測 AI 同時處理多個任務的控制力。

1.  **下令**：在對話框輸入：「請幫我執行 scripts 資料夾下所有的 Python 檔案。」
2.  **觀察 AI 的思考與調度**：
    *   **思考過程**：你會看到介面上出現 `Thought for ...` 的跳動，這是 AI 在進行邏輯拆解（Analyzed scripts）。
    *   **多任務並發**：在側邊欄底部，你會看到 AI 瞬間創建了多個並行的終端機任務。觀察每一個任務條：
        *   你會看到熟悉的 `python3 .../script_name.py` 指令。
        *   注意右下角的狀態：`Exit code 0` 和 `Always Proceed`。
3.  **UI 交互：Go to Terminal vs. Relocate**：
    *   對於簡單的腳本（如 `hello.py`），你會看到 **Go to Terminal**。
    *   特別留意 `path_check.py` 這個任務條，你會看到一個特殊的按鈕：**Relocate（重定位）**。
4.  **Relocate：移動主權**：
    *   點擊 `path_check.py` 任務條上的 **Relocate** 按鈕。
    *   **見證**：你會發現這個原本「活」在側邊欄微型串口裡的任務，瞬間跳轉到了我們 L2 學過的**下方傳統終端機區**。
    *   此時，你可以清晰地觀察到 `path_check.py` 輸出的「路徑儀表盤」（包含 CWD、相對路徑和絕對路徑）。
5.  **閱讀最終總結**：
    *   當所有腳本執行完畢，AI 會給出一個工整的匯總報告。核對一下：`ide_demo.py`、`nothing.py` 等腳本的輸出是否都如預想的一樣？
    *   **主權複位**：你可以在下方終端機區像操作普通終端機一樣繼續輸入指令。這再次證明了：AI 是終端機的「代打」，而你永遠是終端機的「主人」。

---

### 💡 結語：從「工具」到「代理」的思維躍遷
今天你不僅學會了操作側邊欄，更重要的是，你拆解了 AI 工作的暗流：它是如何感知環境、如何選擇 API、如何調度終端機的。

當你學會使用 `@` 指路，並在 `Always Proceed` 的引擎聲中熟練地重定位終端機視窗時，你已經不再是一個被動接收答案的用戶，而是一個正在指揮高度精密工場的**總調度師**。

這種「全速模式」的自動化是一把雙刃劍。當 AI 開始靜悄悄地探測並瞬發指令時，你該如何確保自己在享受效率的同時，不失去對程式碼靈魂的掌控？這就引出了我們下一課的核心：如何檢查 AI 的作業？

---

## 下節課程預覽：如何檢查 AI 的作業？驗證、回饋與糾偏
在踏入真正的編碼實務前，我們需要建立起最後一道防線。我們將探討如何在極速協作中保持清醒，透過 **Human-AI Loop** 建立起真正的工程主權。
